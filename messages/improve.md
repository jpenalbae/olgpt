Now improve the code. Read all the code again show criticism and think about
possible ways to make it more robust and more understandable.

 - Separate the code into more functions or files if you think it helps.
 - Add more files or functions if you think it helps
 - Add comments to make to code clearer
 - Make the code more robust to possible errors
 - Add some kind of help or documentation if you think it helps
 - Remove dummy or duplicate code
